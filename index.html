<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sistema de Rutinas Diarias</title>
    <style>
        :root {
            /* Paleta Base - Dise√±o Calmado */
            --bg-body: #f8fafc;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --shadow-card: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            
            /* Colores de Navegaci√≥n */
            --nav-bg: #ffffff;
            --nav-active: #0f172a;
            --nav-inactive: #94a3b8;

            /* Colores de Bloques (Pasteles Saturados) */
            --c-morning: #e0f2fe; --b-morning: #0284c7; /* Azul Cielo */
            --c-afternoon: #fff7ed; --b-afternoon: #ea580c; /* Naranja Suave */
            --c-night: #f3e8ff; --b-night: #9333ea; /* P√∫rpura */
            --c-check: #dcfce7; --b-check: #16a34a; /* Verde */
            
            --c-gray: #f1f5f9; --b-gray: #cbd5e1; /* Estado Completado */
            
            /* Variantes extra para bloques internos */
            --blk-1: #dbeafe; --blk-1-a: #2563eb;
            --blk-2: #fae8ff; --blk-2-a: #d946ef;
            --blk-3: #ffedd5; --blk-3-a: #f97316;
            --blk-4: #ecfccb; --blk-4-a: #84cc16;
            --blk-5: #ccfbf1; --blk-5-a: #14b8a6;
            --blk-6: #fee2e2; --blk-6-a: #ef4444;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-primary);
            padding-bottom: 100px; /* Espacio para el men√∫ fijo */
            padding-top: 10px;
        }

        /* --- Barra de Progreso Superior --- */
        .progress-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 6px;
            background: #e2e8f0; z-index: 50;
        }
        .progress-bar {
            height: 100%;
            background: #10b981;
            width: 0%;
            transition: width 0.4s ease;
        }

        /* --- Contenedor Principal --- */
        .app-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            opacity: 1;
            transition: opacity 0.2s ease;
        }

        /* --- Header de Secci√≥n --- */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }
        h1 { font-size: 1.4rem; font-weight: 800; line-height: 1.2; }
        .subtitle { font-size: 0.9rem; color: var(--text-secondary); display: block; margin-top: 4px; }
        
        .btn-reset {
            background: white; border: 1px solid #cbd5e1;
            color: var(--text-secondary); padding: 8px 12px;
            border-radius: 20px; font-size: 0.8rem; font-weight: 600;
            cursor: pointer; transition: all 0.2s;
        }
        .btn-reset:active { background: #f1f5f9; transform: scale(0.95); }

        /* --- Bloques de Rutina --- */
        .routine-block {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: var(--shadow-card);
            border-left: 6px solid transparent;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
        }

        .block-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
        .time-badge {
            background: rgba(255,255,255,0.7); padding: 4px 8px;
            border-radius: 6px; font-weight: 700; font-size: 0.95rem;
        }
        .block-title { font-size: 1.15rem; font-weight: 700; margin-top: 8px; }
        .block-objective { font-size: 0.9rem; font-style: italic; opacity: 0.85; margin-bottom: 15px; display: block; }

        .steps-list { list-style: none; margin-bottom: 18px; }
        .steps-list li {
            position: relative; padding-left: 20px; margin-bottom: 8px;
            font-size: 1rem; color: #334155;
        }
        .steps-list li::before { content: "‚Ä¢"; position: absolute; left: 4px; font-weight: bold; }

        .btn-complete {
            width: 100%; padding: 12px; border: none; border-radius: 10px;
            background: white; color: var(--text-primary); font-weight: 700;
            cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            display: flex; align-items: center; justify-content: center; gap: 8px;
            font-size: 1rem; transition: transform 0.1s;
        }
        .btn-complete:active { transform: scale(0.97); }
        .btn-complete::before { content: "‚òê"; font-size: 1.2rem; }

        /* --- Estado Completado --- */
        .routine-block.completed {
            background-color: var(--c-gray) !important;
            border-left-color: var(--b-gray) !important;
            box-shadow: none; border: 1px solid #e2e8f0;
            transform: scale(0.98); opacity: 0.8;
        }
        .routine-block.completed .block-title, 
        .routine-block.completed .time-badge,
        .routine-block.completed li { 
            text-decoration: line-through; color: #94a3b8; 
        }
        .routine-block.completed .btn-complete {
            background: transparent; color: #94a3b8; cursor: default; box-shadow: none;
        }
        .routine-block.completed .btn-complete::before { content: "‚úì"; }
        .routine-block.completed .btn-complete span { display: none; }
        .routine-block.completed .btn-complete::after { content: "Completado"; }

        /* --- Navegaci√≥n Fija Inferior --- */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: var(--nav-bg);
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
            display: flex; justify-content: space-around; padding: 12px 10px 20px 10px;
            z-index: 100; border-top: 1px solid #f1f5f9;
        }
        .nav-btn {
            background: transparent; border: none;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: var(--nav-inactive); cursor: pointer;
            transition: all 0.2s; width: 60px;
        }
        .nav-icon {
            width: 44px; height: 44px; border-radius: 50%;
            background: #f1f5f9; display: flex; align-items: center; justify-content: center;
            font-size: 1.4rem; margin-bottom: 4px; transition: all 0.2s;
        }
        .nav-label { font-size: 0.7rem; font-weight: 600; }
        
        .nav-btn.active { color: var(--nav-active); }
        .nav-btn.active .nav-icon {
            background: var(--nav-active); color: white; transform: translateY(-5px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }

        /* Estilos espec√≠ficos de colores de bloque */
        .b-blue { background-color: var(--blk-1); border-left-color: var(--blk-1-a); }
        .b-purple { background-color: var(--blk-2); border-left-color: var(--blk-2-a); }
        .b-orange { background-color: var(--blk-3); border-left-color: var(--blk-3-a); }
        .b-green { background-color: var(--blk-4); border-left-color: var(--blk-4-a); }
        .b-teal { background-color: var(--blk-5); border-left-color: var(--blk-5-a); }
        .b-red { background-color: var(--blk-6); border-left-color: var(--blk-6-a); }

    </style>
</head>
<body>

    <!-- Barra de Progreso Global (Top) -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- Contenedor Principal Din√°mico -->
    <div class="app-container" id="app">
        <!-- El contenido se inyecta con JS -->
    </div>

    <!-- Navegaci√≥n Fija (Bottom) -->
    <nav class="bottom-nav">
        <button class="nav-btn active" onclick="switchSection('morning')">
            <div class="nav-icon">‚òÄÔ∏è</div>
            <span class="nav-label">Ma√±ana</span>
        </button>
        <button class="nav-btn" onclick="switchSection('afternoon')">
            <div class="nav-icon">üå§Ô∏è</div>
            <span class="nav-label">Tarde</span>
        </button>
        <button class="nav-btn" onclick="switchSection('night')">
            <div class="nav-icon">üåô</div>
            <span class="nav-label">Prep.</span>
        </button>
        <button class="nav-btn" onclick="switchSection('checklist')">
            <div class="nav-icon">‚úÖ</div>
            <span class="nav-label">Check</span>
        </button>
    </nav>

    <script>
        // ==========================================
        // BASE DE DATOS DE RUTINAS
        // ==========================================
        const appData = {
            morning: {
                id: 'morning',
                title: 'Turno de Trabajo Ma√±ana',
                timeRange: '4:30 AM ‚Äì 5:05 AM',
                storageKey: 'routine_morning_v1',
                blocks: [
                    { id: 101, title: 'ACTIVACI√ìN', time: '4:30 ‚Äì 4:35', obj: 'Romper el sue√±o', color: 'b-blue', steps: ['Sonar la alarma', 'Levantarse ya', 'Ir a la cocina', 'Agua a calentar'] },
                    { id: 102, title: 'MOCHILA', time: '4:35 ‚Äì 4:45', obj: 'Mochila lista antes de aseo', color: 'b-orange', steps: ['Mochila vac√≠a', 'Meter tupper', 'Meter ropa trabajo', 'Meter cargador', 'Meter su√©ter', 'Dejar junto a puerta'] },
                    { id: 103, title: 'ROPA', time: '4:45 ‚Äì 4:47', obj: 'Ropa personal lista', color: 'b-purple', steps: ['Revisar camisa', 'Revisar pantal√≥n', 'Revisar calcetas', 'Revisar zapatos', 'Llevar todo al ba√±o'] },
                    { id: 104, title: 'HIGIENE', time: '4:47 ‚Äì 4:50', obj: 'Higiene bucal', color: 'b-green', steps: ['Lavarse los dientes bien'] },
                    { id: 105, title: 'BA√ëO', time: '4:50 ‚Äì 5:00', obj: 'Limpieza y vestir', color: 'b-teal', steps: ['Ba√±arse', 'Secarse', 'Vestirse', 'Ir al ba√±o (prevenci√≥n)'] },
                    { id: 106, title: 'SALIDA', time: '5:00 ‚Äì 5:05', obj: 'Check final cr√≠tico', color: 'b-red', steps: ['Mochila cerrada', 'Comida dentro', 'Ropa trabajo dentro', 'Cargador dentro', 'Llaves y dinero', 'Apagar luces', 'Salir'] }
                ]
            },
            afternoon: {
                id: 'afternoon',
                title: 'Turno de Trabajo Tarde',
                timeRange: '11:30 AM ‚Äì 12:20 PM',
                storageKey: 'routine_afternoon_v1',
                blocks: [
                    { id: 201, title: 'ACTIVACI√ìN', time: '11:30 ‚Äì 11:35', obj: 'Inicio de rutina', color: 'b-blue', steps: ['Dejar de hacer otras cosas', 'Hidratarse', 'Mentalizarse para salir'] },
                    { id: 202, title: 'MOCHILA', time: '11:35 ‚Äì 11:45', obj: 'Armado de equipo', color: 'b-orange', steps: ['Revisar mochila vac√≠a', 'Meter comida del d√≠a', 'Meter ropa de trabajo', 'Meter su√©ter', 'Cargador celular', 'Dejar junto a puerta'] },
                    { id: 203, title: 'ROPA', time: '11:45 ‚Äì 11:50', obj: 'Preparaci√≥n personal', color: 'b-purple', steps: ['Elegir ropa c√≥moda', 'Revisar zapatos', 'Llevar toalla al ba√±o'] },
                    { id: 204, title: 'HIGIENE', time: '11:50 ‚Äì 11:55', obj: 'Limpieza bucal', color: 'b-green', steps: ['Lavarse los dientes', 'Usar hilo dental'] },
                    { id: 205, title: 'BA√ëO', time: '11:55 ‚Äì 12:10', obj: 'Aseo personal', color: 'b-teal', steps: ['Ducha completa', 'Secarse bien', 'Vestirse', 'Peinarse'] },
                    { id: 206, title: 'SALIDA', time: '12:10 ‚Äì 12:20', obj: 'Salida sin estr√©s', color: 'b-red', steps: ['Verificar mochila completa', 'Verificar llaves', 'Verificar cartera/credencial', 'Cerrar ventanas', 'Salir con tiempo'] }
                ]
            },
            night: {
                id: 'night',
                title: 'Preparaci√≥n Noche Anterior',
                timeRange: '11:00 PM ‚Äì 11:30 PM',
                storageKey: 'routine_night_v1',
                blocks: [
                    { id: 301, title: 'COMIDA', time: '23:00', obj: 'Evitar cocinar ma√±ana', color: 'b-green', steps: ['Preparar tupper', 'Dejar en refri o mesa', 'Lavar trastes usados'] },
                    { id: 302, title: 'ROPA TRABAJO', time: '23:10', obj: 'Uniforme listo', color: 'b-blue', steps: ['Buscar uniforme limpio', 'Doblar ordenado', 'Dejar visible'] },
                    { id: 303, title: 'ROPA BA√ëO', time: '23:15', obj: 'Para vestirse al salir', color: 'b-purple', steps: ['Sacar ropa interior', 'Sacar calcetas', 'Dejar toalla lista'] },
                    { id: 304, title: 'MOCHILA', time: '23:20', obj: 'Pre-armado', color: 'b-orange', steps: ['Meter cargador', 'Meter su√©ter', 'Meter libreta/plumas', 'Dejar mochila abierta en silla'] },
                    { id: 305, title: 'CHECK', time: '23:25', obj: 'Tranquilidad mental', color: 'b-teal', steps: ['Verificar alarma puesta', 'Celular cargando lejos'] }
                ]
            },
            checklist: {
                id: 'checklist',
                title: 'Checklist Cr√≠tico',
                timeRange: 'Verificaci√≥n Final',
                storageKey: 'routine_checklist_v1',
                blocks: [
                    { id: 401, title: 'MOCHILA', time: 'CHECK', obj: '¬øTiene todo?', color: 'b-red', steps: ['¬øEst√° cerrada?', '¬øPesa lo correcto?'] },
                    { id: 402, title: 'ELEMENTOS', time: 'CHECK', obj: 'Indispensables', color: 'b-orange', steps: ['Comida', 'Ropa trabajo', 'Cargador', 'Su√©ter'] },
                    { id: 403, title: 'BOLSILLO', time: 'CHECK', obj: 'Para salir', color: 'b-blue', steps: ['Llaves de casa', 'Dinero / Cartera', 'Credencial trabajo', 'Cubrebocas (si aplica)'] }
                ]
            }
        };

        // ==========================================
        // ESTADO Y L√ìGICA
        // ==========================================
        
        // Estado actual de la aplicaci√≥n
        let currentSectionId = 'morning';
        
        // Funci√≥n para cargar estado del localStorage
        function loadState(key) {
            return JSON.parse(localStorage.getItem(key)) || [];
        }

        // Funci√≥n para guardar estado
        function saveState(key, data) {
            localStorage.setItem(key, JSON.stringify(data));
        }

        // Funci√≥n principal de renderizado
        function render() {
            const container = document.getElementById('app');
            const data = appData[currentSectionId];
            const completedBlocks = loadState(data.storageKey);
            
            // 1. Actualizar Botones de Navegaci√≥n
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            // Busca el bot√≥n que llama a esta secci√≥n (hack simple basado en onclick string)
            const navButtons = document.querySelectorAll('.nav-btn');
            if(currentSectionId === 'morning') navButtons[0].classList.add('active');
            if(currentSectionId === 'afternoon') navButtons[1].classList.add('active');
            if(currentSectionId === 'night') navButtons[2].classList.add('active');
            if(currentSectionId === 'checklist') navButtons[3].classList.add('active');

            // 2. Generar HTML del Header
            let html = `
                <header>
                    <div>
                        <h1>${data.title}</h1>
                        <span class="subtitle">${data.timeRange}</span>
                    </div>
                    <button class="btn-reset" onclick="resetSection()">Reiniciar</button>
                </header>
            `;

            // 3. Generar Bloques
            data.blocks.forEach(block => {
                const isCompleted = completedBlocks.includes(block.id);
                const stepsHtml = block.steps.map(s => `<li>${s}</li>`).join('');
                
                html += `
                    <div class="routine-block ${block.color} ${isCompleted ? 'completed' : ''}" id="blk-${block.id}">
                        <div class="block-header">
                            <div>
                                <span class="time-badge">${block.time}</span>
                                <h2 class="block-title">${block.title}</h2>
                            </div>
                        </div>
                        <span class="block-objective">${block.obj}</span>
                        <ul class="steps-list">
                            ${stepsHtml}
                        </ul>
                        <button class="btn-complete" onclick="toggleBlock(${block.id})">
                            <span>Marcar como completado</span>
                        </button>
                    </div>
                `;
            });

            container.innerHTML = html;
            
            // 4. Actualizar Barra de Progreso
            updateProgress(data.blocks.length, completedBlocks.length);
            
            // Scroll suave arriba al cambiar secci√≥n
            // (Opcional, pero ayuda a sentir el cambio de contexto)
        }

        // Cambiar secci√≥n
        function switchSection(sectionId) {
            // Efecto visual de desvanecimiento simple
            const container = document.getElementById('app');
            container.style.opacity = '0';
            
            setTimeout(() => {
                currentSectionId = sectionId;
                render();
                container.style.opacity = '1';
                window.scrollTo({top: 0, behavior: 'auto'});
            }, 200);
        }

        // Marcar/Desmarcar bloque
        function toggleBlock(blockId) {
            const data = appData[currentSectionId];
            let completed = loadState(data.storageKey);
            
            if (completed.includes(blockId)) {
                completed = completed.filter(id => id !== blockId);
            } else {
                completed.push(blockId);
            }
            
            saveState(data.storageKey, completed);
            render(); // Re-renderizar para actualizar UI
        }

        // Reiniciar secci√≥n actual
        function resetSection() {
            if(confirm('¬øReiniciar esta secci√≥n?')) {
                const data = appData[currentSectionId];
                saveState(data.storageKey, []);
                render();
            }
        }

        // Actualizar barra de progreso
        function updateProgress(total, current) {
            const percent = total === 0 ? 0 : (current / total) * 100;
            document.getElementById('progressBar').style.width = `${percent}%`;
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', () => {
            render();
        });

    </script>
</body>
</html>


<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen Avanzado de Frontend</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #3498db;
            --success: #2ecc71;
            --danger: #e74c3c;
            --dark: #2c3e50;
            --light: #ecf0f1;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            max-width: 1000px;
            width: 100%;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        header {
            background: var(--dark);
            color: white;
            text-align: center;
            padding: 25px 20px;
            position: relative;
        }
        
        header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .progress-container {
            width: 100%;
            height: 10px;
            background: #ddd;
            margin-top: 20px;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        #quiz-container {
            padding: 30px;
            min-height: 500px;
        }
        
        .question-container {
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 10px;
            background-color: #f9f9f9;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            display: none;
        }
        
        .question-container.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .question-number {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        
        .question-text {
            font-size: 1.1rem;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .option {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
        }
        
        .option:hover {
            background-color: #f0f8ff;
            border-color: var(--primary);
        }
        
        .option.selected {
            background-color: #d4edff;
            border-color: var(--primary);
        }
        
        .option input {
            margin-right: 10px;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-prev {
            background-color: #e0e0e0;
        }
        
        .btn-next {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-submit {
            background-color: var(--success);
            color: white;
        }
        
        #result-container {
            display: none;
            padding: 30px;
            text-align: center;
        }
        
        .token-info {
            background: #f0f8ff;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: monospace;
        }
        
        .result-header {
            margin-bottom: 30px;
        }
        
        .result-header h2 {
            font-size: 2rem;
            color: var(--dark);
            margin-bottom: 10px;
        }
        
        .score-circle {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            margin: 0 auto 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: bold;
            color: white;
            position: relative;
            background: conic-gradient(var(--success) 0%, var(--success) var(--p), #f0f0f0 var(--p), #f0f0f0 100%);
        }
        
        .score-circle::before {
            content: '';
            position: absolute;
            width: 160px;
            height: 160px;
            border-radius: 50%;
            background: white;
        }
        
        .score-text {
            position: relative;
            z-index: 1;
        }
        
        .level-indicator {
            font-size: 1.4rem;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .feedback {
            max-width: 600px;
            margin: 0 auto 30px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            text-align: left;
            line-height: 1.6;
        }
        
        .details-container {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .detail-card {
            flex: 1;
            min-width: 200px;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .correct {
            background-color: rgba(46, 204, 113, 0.15);
            border-left: 4px solid var(--success);
        }
        
        .incorrect {
            background-color: rgba(231, 76, 60, 0.15);
            border-left: 4px solid var(--danger);
        }
        
        .detail-card h3 {
            margin-bottom: 10px;
            font-size: 1.4rem;
        }
        
        .detail-card p {
            font-size: 2rem;
            font-weight: bold;
        }
        
        .questions-review {
            text-align: left;
            margin: 30px 0;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #eee;
            border-radius: 8px;
        }
        
        .review-item {
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        
        .review-item.correct {
            border-left: 4px solid var(--success);
        }
        
        .review-item.incorrect {
            border-left: 4px solid var(--danger);
        }
        
        .question-review-text {
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .answer-status {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            margin-bottom: 10px;
        }
        
        .correct .answer-status {
            background-color: var(--success);
            color: white;
        }
        
        .incorrect .answer-status {
            background-color: var(--danger);
            color: white;
        }
        
        .user-answer, .correct-answer {
            margin: 5px 0;
            padding-left: 15px;
        }
        
        .btn-pdf {
            background-color: var(--danger);
            color: white;
            font-size: 1.1rem;
            padding: 15px 30px;
            margin: 20px auto;
        }
        
        .skill-meter {
            width: 100%;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .skill-level {
            height: 100%;
            border-radius: 10px;
            background: linear-gradient(90deg, #f39c12, #e74c3c, #3498db, #2ecc71);
        }
        
        .skill-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 30px;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background-color: var(--dark);
            color: white;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }
            
            .details-container {
                flex-direction: column;
            }
            
            .score-circle {
                width: 150px;
                height: 150px;
            }
            
            .score-circle::before {
                width: 130px;
                height: 130px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Examen Avanzado de Frontend</h1>
            <p>50 preguntas para evaluar tus conocimientos en HTML, CSS, JavaScript y conceptos modernos</p>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
        </header>
        
        <div id="quiz-container">
            <!-- Las preguntas se generarán dinámicamente -->
        </div>
        
        <div id="result-container">
            <div class="token-info" id="token-info">
                Tokens usados: calculando... | Disponibles: 128,000 | % restante: 100%
            </div>
            
            <div class="result-header">
                <h2>Resultados del Examen</h2>
                <div class="score-circle" id="score-circle">
                    <div class="score-text" id="score-text">0%</div>
                </div>
                <div class="level-indicator" id="level-indicator">Principiante</div>
                <div class="feedback" id="feedback">
                    Basado en tus respuestas, estás en el nivel principiante. Sigue practicando los conceptos fundamentales.
                </div>
            </div>
            
            <div class="details-container">
                <div class="detail-card correct">
                    <h3>Correctas</h3>
                    <p id="correct-count">0</p>
                </div>
                <div class="detail-card incorrect">
                    <h3>Incorrectas</h3>
                    <p id="incorrect-count">0</p>
                </div>
                <div class="detail-card">
                    <h3>Puntuación</h3>
                    <p id="final-score">0%</p>
                </div>
            </div>
            
            <div class="questions-review">
                <h3>Revisión de Preguntas:</h3>
                <div id="questions-review-container">
                    <!-- Las revisiones de preguntas se generarán aquí -->
                </div>
            </div>
            
            <button class="btn btn-pdf" id="btn-pdf">
                Exportar Resultados a PDF
            </button>
        </div>
        
        <footer>
            <p>Examen Avanzado de Frontend &copy; 2023 - Nivel de conocimientos</p>
        </footer>
    </div>

    <script>
        // Datos del cuestionario (50 preguntas completas)
        const quizData = [
            // HTML (10 preguntas)
            {
                question: "¿Qué atributo HTML5 se utiliza para validar un campo de entrada como requerido?",
                options: ["mandatory", "validate", "required", "mustfill"],
                answer: 2,
                category: "HTML"
            },
            {
                question: "¿Cuál es el propósito de la etiqueta <section> en HTML5?",
                options: [
                    "Agrupar contenido relacionado temáticamente",
                    "Crear una sección de navegación",
                    "Definir contenido independiente",
                    "Agrupar elementos inline"
                ],
                answer: 0,
                category: "HTML"
            },
            {
                question: "¿Cómo se define un enlace que abre en una nueva pestaña?",
                options: [
                    '<a href="url" target="_blank">',
                    '<a href="url" new="tab">',
                    '<a href="url" open="new">',
                    '<a href="url" target="new">'
                ],
                answer: 0,
                category: "HTML"
            },
            {
                question: "¿Qué elemento HTML se usa para representar una barra de progreso?",
                options: ["<loading>", "<progress>", "<status>", "<bar>"],
                answer: 1,
                category: "HTML"
            },
            {
                question: "¿Para qué se utiliza el atributo 'defer' en una etiqueta <script>?",
                options: [
                    "Para ejecutar el script antes de que el DOM esté completamente cargado",
                    "Para posponer la ejecución del script hasta que el documento esté completamente analizado",
                    "Para cargar el script de forma asíncrona",
                    "Para evitar que el script se ejecute"
                ],
                answer: 1,
                category: "HTML"
            },
            {
                question: "¿Qué elemento HTML5 se utiliza para representar contenido independiente?",
                options: ["<section>", "<article>", "<div>", "<aside>"],
                answer: 1,
                category: "HTML"
            },
            {
                question: "¿Cómo se define un campo de entrada para correo electrónico?",
                options: [
                    '<input type="text" format="email">',
                    '<input type="email">',
                    '<input type="mail">',
                    '<email>'
                ],
                answer: 1,
                category: "HTML"
            },
            {
                question: "¿Qué elemento se usa para agrupar opciones en un elemento <select>?",
                options: ["<group>", "<optgroup>", "<optiongroup>", "<options>"],
                answer: 1,
                category: "HTML"
            },
            {
                question: "¿Para qué se utiliza el elemento <canvas>?",
                options: [
                    "Para mostrar imágenes vectoriales",
                    "Para dibujar gráficos mediante JavaScript",
                    "Para mostrar contenido multimedia",
                    "Para crear tablas"
                ],
                answer: 1,
                category: "HTML"
            },
            {
                question: "¿Qué atributo se usa para especificar un texto alternativo en imágenes?",
                options: ["alt", "title", "description", "text"],
                answer: 0,
                category: "HTML"
            },
            
            // CSS (15 preguntas)
            {
                question: "¿Qué propiedad CSS se usa para crear efectos de transición?",
                options: ["animation", "transform", "transition", "change"],
                answer: 2,
                category: "CSS"
            },
            {
                question: "¿Cuál es la diferencia entre 'em' y 'rem' en CSS?",
                options: [
                    "'em' es relativo al tamaño de fuente del elemento raíz, 'rem' al elemento padre",
                    "'em' es relativo al tamaño de fuente del elemento padre, 'rem' al elemento raíz",
                    "Ambos son iguales",
                    "'em' es para márgenes, 'rem' para fuentes"
                ],
                answer: 1,
                category: "CSS"
            },
            {
                question: "¿Qué hace la propiedad 'will-change' en CSS?",
                options: [
                    "Indica que una propiedad cambiará su valor",
                    "Optimiza las animaciones indicando qué propiedades cambiarán",
                    "Fuerza un repintado del elemento",
                    "Cambia el comportamiento de las transiciones"
                ],
                answer: 1,
                category: "CSS"
            },
            {
                question: "¿Cómo se crea un diseño de cuadrícula (grid) con CSS?",
                options: [
                    "display: grid;",
                    "layout: grid;",
                    "display: flex-grid;",
                    "grid: enabled;"
                ],
                answer: 0,
                category: "CSS"
            },
            {
                question: "¿Qué selector CSS tiene mayor especificidad?",
                options: [".clase", "#id", "element", "::pseudo-element"],
                answer: 1,
                category: "CSS"
            },
            {
                question: "¿Qué propiedad se usa para cambiar el orden de visualización de elementos flex?",
                options: ["order", "flex-order", "display-order", "position"],
                answer: 0,
                category: "CSS"
            },
            {
                question: "¿Cómo se aplica un estilo solo cuando el ratón está sobre un elemento?",
                options: [":hover", ":active", ":focus", ":mouseover"],
                answer: 0,
                category: "CSS"
            },
            {
                question: "¿Qué propiedad CSS se usa para crear transparencia?",
                options: ["transparency", "opacity", "alpha", "visibility"],
                answer: 1,
                category: "CSS"
            },
            {
                question: "¿Cómo se centra un elemento horizontalmente con CSS?",
                options: [
                    "margin: 0 auto;",
                    "center: true;",
                    "align: center;",
                    "horizontal-align: middle;"
                ],
                answer: 0,
                category: "CSS"
            },
            {
                question: "¿Qué hace 'z-index' en CSS?",
                options: [
                    "Controla el orden de apilamiento de elementos",
                    "Controla el tamaño en el eje Z",
                    "Aplica efectos 3D",
                    "Controla la rotación de elementos"
                ],
                answer: 0,
                category: "CSS"
            },
            {
                question: "¿Qué propiedad CSS se usa para crear sombras en elementos?",
                options: ["shadow", "element-shadow", "box-shadow", "drop-shadow"],
                answer: 2,
                category: "CSS"
            },
            {
                question: "¿Cómo se aplican estilos diferentes para impresión?",
                options: [
                    "@media print",
                    "<link media='print'>",
                    "@print",
                    "media='print'"
                ],
                answer: 0,
                category: "CSS"
            },
            {
                question: "¿Qué es Flexbox en CSS?",
                options: [
                    "Un modelo de diseño unidimensional",
                    "Un modelo de diseño bidimensional",
                    "Una técnica de animación",
                    "Un tipo de selector"
                ],
                answer: 0,
                category: "CSS"
            },
            {
                question: "¿Qué propiedad se usa para definir el tamaño de fuente?",
                options: ["text-size", "font-size", "size", "font"],
                answer: 1,
                category: "CSS"
            },
            {
                question: "¿Cómo se crea un gradiente lineal en CSS?",
                options: [
                    "background: linear-gradient(...);",
                    "gradient: linear(...);",
                    "background-color: gradient(...);",
                    "linear-gradient: background(...);"
                ],
                answer: 0,
                category: "CSS"
            },
            
            // JavaScript (20 preguntas)
            {
                question: "¿Qué es el hoisting en JavaScript?",
                options: [
                    "Un patrón de diseño",
                    "Un método para elevar elementos en el DOM",
                    "El comportamiento de mover declaraciones al inicio del ámbito",
                    "Una técnica de optimización"
                ],
                answer: 2,
                category: "JavaScript"
            },
            {
                question: "¿Qué hace 'use strict' en JavaScript?",
                options: [
                    "Habilita el modo estricto con más reglas y mejores errores",
                    "Fuerza la tipificación estricta de variables",
                    "Activa el modo de depuración",
                    "Optimiza el rendimiento del código"
                ],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Qué es una clausura (closure) en JavaScript?",
                options: [
                    "Una función que recuerda su entorno léxico",
                    "Un método para cerrar conexiones",
                    "Un patrón de diseño de objetos",
                    "Una función que se llama a sí misma"
                ],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Cómo se crea una promesa en JavaScript?",
                options: [
                    "new Promise()",
                    "Promise.create()",
                    "createPromise()",
                    "Promise()"
                ],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Qué método se usa para transformar un array en JavaScript?",
                options: ["map()", "forEach()", "loop()", "convert()"],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Cuál es la diferencia entre == y === en JavaScript?",
                options: [
                    "== compara valor, === compara valor y tipo",
                    "== compara valor y tipo, === compara solo valor",
                    "No hay diferencia",
                    "== es para números, === para strings"
                ],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Qué es 'this' en JavaScript?",
                options: [
                    "Referencia al objeto actual de ejecución",
                    "Palabra reservada para funciones",
                    "Referencia a la función padre",
                    "Variable global"
                ],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Cómo se clona un objeto en JavaScript?",
                options: [
                    "Object.assign({}, obj)",
                    "obj.clone()",
                    "JSON.clone(obj)",
                    "clone(obj)"
                ],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Qué método detiene la propagación de eventos?",
                options: ["event.stop()", "stopPropagation()", "cancelEvent()", "preventDefault()"],
                answer: 1,
                category: "JavaScript"
            },
            {
                question: "¿Qué es un callback en JavaScript?",
                options: [
                    "Una función que se pasa como argumento a otra función",
                    "Un método para llamadas HTTP",
                    "Un tipo de bucle",
                    "Un patrón de diseño"
                ],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Cómo se crea un elemento en el DOM?",
                options: [
                    "document.createElement()",
                    "document.newElement()",
                    "element.create()",
                    "DOM.createElement()"
                ],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Qué hace JSON.parse()?",
                options: [
                    "Convierte un objeto JavaScript a JSON",
                    "Convierte JSON a objeto JavaScript",
                    "Valida JSON",
                    "Serializa datos"
                ],
                answer: 1,
                category: "JavaScript"
            },
            {
                question: "¿Qué es async/await?",
                options: [
                    "Sintaxis para manejar promesas de forma síncrona",
                    "Método para crear hilos",
                    "Patrón de diseño para eventos",
                    "Técnica de optimización"
                ],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Qué método se usa para seleccionar múltiples elementos?",
                options: [
                    "document.querySelectorAll()",
                    "document.getElements()",
                    "document.selectAll()",
                    "document.find()"
                ],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Cómo se elimina un elemento del DOM?",
                options: [
                    "element.remove()",
                    "document.removeChild(element)",
                    "element.delete()",
                    "Todas las anteriores"
                ],
                answer: 3,
                category: "JavaScript"
            },
            {
                question: "¿Qué es una función flecha (arrow function)?",
                options: [
                    "Función con sintaxis compacta y 'this' léxico",
                    "Función que retorna flechas",
                    "Función asíncrona",
                    "Función generadora"
                ],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Qué método añade un elemento al final de un array?",
                options: ["push()", "append()", "add()", "insert()"],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Qué es el event bubbling?",
                options: [
                    "Propagación de eventos desde el elemento objetivo hacia arriba",
                    "Propagación de eventos desde el elemento raíz hacia abajo",
                    "Método para cancelar eventos",
                    "Técnica de optimización de eventos"
                ],
                answer: 0,
                category: "JavaScript"
            },
            {
                question: "¿Cómo se previene el comportamiento por defecto de un evento?",
                options: [
                    "event.stop()",
                    "event.preventDefault()",
                    "event.cancel()",
                    "event.block()"
                ],
                answer: 1,
                category: "JavaScript"
            },
            {
                question: "¿Qué es un módulo en JavaScript?",
                options: [
                    "Archivo con código reutilizable",
                    "Patrón de diseño",
                    "Tipo de función",
                    "Objeto global"
                ],
                answer: 0,
                category: "JavaScript"
            },
            
            // Conceptos avanzados (5 preguntas)
            {
                question: "¿Qué es el Virtual DOM en React?",
                options: [
                    "Una representación ligera del DOM real",
                    "Un DOM para dispositivos virtuales",
                    "Un patrón de diseño de servidor",
                    "Un DOM optimizado para móviles"
                ],
                answer: 0,
                category: "Conceptos"
            },
            {
                question: "¿Qué es Webpack?",
                options: [
                    "Un empaquetador de módulos",
                    "Un framework CSS",
                    "Una librería de animaciones",
                    "Un protocolo de red"
                ],
                answer: 0,
                category: "Herramientas"
            },
            {
                question: "¿Qué es un componente en React?",
                options: [
                    "Una pieza reutilizable de UI",
                    "Un archivo de configuración",
                    "Un módulo de JavaScript",
                    "Un objeto de estado"
                ],
                answer: 0,
                category: "React"
            },
            {
                question: "¿Qué es Babel?",
                options: [
                    "Un transpilador de JavaScript",
                    "Un framework frontend",
                    "Una librería de utilidades",
                    "Un gestor de paquetes"
                ],
                answer: 0,
                category: "Herramientas"
            },
            {
                question: "¿Qué es el ciclo de vida en React?",
                options: [
                    "Métodos que se ejecutan en diferentes fases de un componente",
                    "Tiempo de ejecución de una aplicación",
                    "Duración de un estado",
                    "Proceso de compilación"
                ],
                answer: 0,
                category: "React"
            }
        ];

        // Variables de estado
        let currentQuestion = 0;
        let userAnswers = new Array(quizData.length).fill(-1);
        let quizCompleted = false;
        let tokenCount = 0;

        // Elementos DOM
        const quizContainer = document.getElementById('quiz-container');
        const resultContainer = document.getElementById('result-container');
        const progressBar = document.getElementById('progress-bar');
        const btnPdf = document.getElementById('btn-pdf');
        const tokenInfo = document.getElementById('token-info');

        // Función para actualizar información de tokens
        function updateTokenInfo(inputTokens = 0, outputTokens = 0) {
            // Contabilizar tokens
            tokenCount += inputTokens + outputTokens;
            
            // Calcular disponibilidad
            const maxTokens = 128000;
            const remainingTokens = maxTokens - tokenCount;
            const percentage = ((remainingTokens / maxTokens) * 100).toFixed(1);
            
            // Actualizar UI
            tokenInfo.textContent = `Tokens usados: ${tokenCount} | Disponibles: ${remainingTokens} | % restante: ${percentage}%`;
        }

        // Inicializar el cuestionario
        function initQuiz() {
            renderQuestion();
            updateProgressBar();
            updateTokenInfo(120, 0); // Tokens iniciales
        }

        // Renderizar pregunta actual
        function renderQuestion() {
            const question = quizData[currentQuestion];
            
            const questionHTML = `
                <div class="question-container active">
                    <div class="question-number">Pregunta ${currentQuestion + 1} de ${quizData.length}</div>
                    <div class="question-text">${question.question}</div>
                    <div class="options-container">
                        ${question.options.map((option, index) => `
                            <div class="option ${userAnswers[currentQuestion] === index ? 'selected' : ''}" 
                                 onclick="selectOption(${index})">
                                <input type="radio" name="option" ${userAnswers[currentQuestion] === index ? 'checked' : ''}>
                                <label>${option}</label>
                            </div>
                        `).join('')}
                    </div>
                    <div class="navigation">
                        <button class="btn btn-prev" ${currentQuestion === 0 ? 'disabled' : ''} onclick="prevQuestion()">
                            Anterior
                        </button>
                        ${currentQuestion < quizData.length - 1 ? `
                            <button class="btn btn-next" onclick="nextQuestion()">
                                Siguiente
                            </button>
                        ` : `
                            <button class="btn btn-submit" onclick="finishQuiz()">
                                Terminar Examen
                            </button>
                        `}
                    </div>
                </div>
            `;
            
            quizContainer.innerHTML = questionHTML;
            updateTokenInfo(0, 50); // Estimación tokens por pregunta
        }

        // Seleccionar una opción
        function selectOption(index) {
            userAnswers[currentQuestion] = index;
            renderQuestion();
        }

        // Ir a la pregunta anterior
        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
                updateProgressBar();
            }
        }

        // Ir a la siguiente pregunta
        function nextQuestion() {
            if (currentQuestion < quizData.length - 1) {
                if (userAnswers[currentQuestion] === -1) {
                    alert("Por favor selecciona una respuesta antes de continuar.");
                    return;
                }
                currentQuestion++;
                renderQuestion();
                updateProgressBar();
            }
        }

        // Actualizar barra de progreso
        function updateProgressBar() {
            const progress = ((currentQuestion + 1) / quizData.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // Finalizar el cuestionario y mostrar resultados
        function finishQuiz() {
            if (userAnswers[currentQuestion] === -1) {
                alert("Por favor selecciona una respuesta antes de terminar el examen.");
                return;
            }
            
            quizCompleted = true;
            
            // Calcular puntuación
            let correctCount = 0;
            quizData.forEach((question, index) => {
                if (userAnswers[index] === question.answer) {
                    correctCount++;
                }
            });
            
            const score = Math.round((correctCount / quizData.length) * 100);
            
            // Mostrar resultados
            document.getElementById('correct-count').textContent = correctCount;
            document.getElementById('incorrect-count').textContent = quizData.length - correctCount;
            document.getElementById('final-score').textContent = `${score}%`;
            document.getElementById('score-text').textContent = `${score}%`;
            
            // Actualizar círculo de puntuación
            const scoreCircle = document.getElementById('score-circle');
            scoreCircle.style.setProperty('--p', `${score}%`);
            
            // Determinar nivel
            let level = "";
            let feedback = "";
            
            if (score < 40) {
                level = "Principiante";
                feedback = "Estás en el nivel principiante. Te recomiendo enfocarte en los fundamentos de HTML, CSS y JavaScript.";
            } else if (score < 70) {
                level = "Intermedio";
                feedback = "Tienes un conocimiento intermedio de desarrollo frontend. Sigue practicando y profundizando en conceptos avanzados.";
            } else if (score < 90) {
                level = "Avanzado";
                feedback = "¡Buen trabajo! Tienes conocimientos avanzados en desarrollo frontend. Estás listo para comenzar con frameworks como React o Vue.";
            } else {
                level = "Experto";
                feedback = "¡Excelente! Tienes un conocimiento experto en desarrollo frontend. Ahora puedes enfocarte en temas avanzados como optimización y arquitectura.";
            }
            
            document.getElementById('level-indicator').textContent = level;
            document.getElementById('feedback').textContent = feedback;
            
            // Generar revisión de preguntas
            let reviewHTML = "";
            quizData.forEach((question, index) => {
                const isCorrect = userAnswers[index] === question.answer;
                const userAnswerText = userAnswers[index] !== -1 ? 
                    question.options[userAnswers[index]] : "Sin responder";
                const correctAnswerText = question.options[question.answer];
                
                reviewHTML += `
                    <div class="review-item ${isCorrect ? 'correct' : 'incorrect'}">
                        <div class="question-review-text">${index + 1}. ${question.question}</div>
                        <div class="answer-status">${isCorrect ? 'Correcta' : 'Incorrecta'}</div>
                        <div class="user-answer"><strong>Tu respuesta:</strong> ${userAnswerText}</div>
                        ${!isCorrect ? `<div class="correct-answer"><strong>Respuesta correcta:</strong> ${correctAnswerText}</div>` : ''}
                        <div class="category"><strong>Categoría:</strong> ${question.category}</div>
                    </div>
                `;
            });
            
            document.getElementById('questions-review-container').innerHTML = reviewHTML;
            
            // Mostrar resultados y ocultar cuestionario
            quizContainer.style.display = 'none';
            resultContainer.style.display = 'block';
            
            // Actualizar tokens
            updateTokenInfo(0, 800); // Tokens para mostrar resultados
        }

        // Generar PDF
        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            
            // Título
            doc.setFontSize(22);
            doc.setTextColor(44, 62, 80);
            doc.text("Resultados de Evaluación Frontend", 105, 20, null, null, 'center');
            
            // Información del estudiante
            doc.setFontSize(12);
            doc.setTextColor(100, 100, 100);
            const studentName = prompt("Por favor ingresa tu nombre:", "Estudiante");
            doc.text(`Fecha: ${new Date().toLocaleDateString()}`, 20, 35);
            doc.text(`Estudiante: ${studentName}`, 20, 42);
            
            // Puntuación
            doc.setFontSize(16);
            doc.setTextColor(52, 152, 219);
            doc.text("Resumen de Puntuación", 20, 60);
            
            doc.setDrawColor(200, 200, 200);
            doc.setLineWidth(0.2);
            doc.line(20, 65, 190, 65);
            
            doc.setFontSize(14);
            doc.setTextColor(0, 0, 0);
            doc.text(`Puntuación final: ${document.getElementById('final-score').textContent}`, 25, 75);
            doc.text(`Nivel: ${document.getElementById('level-indicator').textContent}`, 25, 85);
            
            // Revisión de preguntas
            doc.setFontSize(16);
            doc.setTextColor(52, 152, 219);
            doc.text("Detalle de Respuestas", 20, 100);
            doc.line(20, 105, 190, 105);
            
            let yPos = 115;
            quizData.forEach((question, index) => {
                if (yPos > 270) {
                    doc.addPage();
                    yPos = 20;
                }
                
                const isCorrect = userAnswers[index] === question.answer;
                const userAnswerText = userAnswers[index] !== -1 ? 
                    question.options[userAnswers[index]] : "Sin responder";
                const correctAnswerText = question.options[question.answer];
                
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                doc.text(`${index + 1}. ${question.question}`, 25, yPos);
                
                doc.setFontSize(9);
                doc.setTextColor(isCorrect ? 46 : 231, isCorrect ? 204 : 76, isCorrect ? 113 : 60);
                doc.text(`Respuesta: ${isCorrect ? 'Correcta' : 'Incorrecta'}`, 25, yPos + 5);
                
                doc.setTextColor(0, 0, 0);
                doc.text(`Tu respuesta: ${userAnswerText}`, 25, yPos + 10);
                
                if (!isCorrect) {
                    doc.setTextColor(46, 204, 113);
                    doc.text(`Respuesta correcta: ${correctAnswerText}`, 25, yPos + 15);
                }
                
                doc.setTextColor(100, 100, 100);
                doc.text(`Categoría: ${question.category}`, 25, yPos + (isCorrect ? 20 : 25));
                
                yPos += (isCorrect ? 25 : 30);
            });
            
            // Pie de página
            doc.setFontSize(10);
            doc.setTextColor(100, 100, 100);
            doc.text("Examen Avanzado de Frontend © 2023", 105, 290, null, null, 'center');
            
            // Guardar PDF
            doc.save(`resultados-frontend-${studentName}.pdf`);
            updateTokenInfo(0, 300); // Tokens para generar PDF
        }

        // Event listeners
        btnPdf.addEventListener('click', generatePDF);

        // Inicializar
        window.onload = initQuiz;
        window.selectOption = selectOption;
        window.prevQuestion = prevQuestion;
        window.nextQuestion = nextQuestion;
        window.finishQuiz = finishQuiz;
    </script>
</body>
</html>
